<html>
<head>
    <script type="text/javascript">
        function getElementsByClassName(clsName, tagName) {
            var ClassElements = [];
            selElements = document.getElementsByTagName(tagName);

            for (var i = 0; i < selElements.length; i++) {
                if (selElements[i].className == clsName) {
                    ClassElements[ClassElements.length] = selElements[i];
                }
            }
            return ClassElements;
        }
        window.onload=function(){
            HotKeyHandler.Init();

            var textA = document.getElementById("test-text")
            textA.onkeydown=function(event) {
                console.info("getElementById handler run...")
                return true;
            }
            textA.addEventListener('paste', (event) => {
                let paste = (event.clipboardData || window.clipboardData).getData('text');
                paste = paste.toUpperCase();

                const selection = window.getSelection();
                if (!selection.rangeCount) return false;
                selection.deleteFromDocument();
                selection.getRangeAt(0).insertNode(document.createTextNode(paste));

                event.preventDefault();
            });
        }
        var HotKeyHandler={
            currentMainKey:null,
            currentValueKey:null,
            Init:function(){
                // HotKeyHandler.Register(0,"K",function(){alert("注册成功");});
                HotKeyHandler.Register(0,"Z",function(){
                    console.info("HotKeyHandler handler run...")
                    return false;
                    // var e = getElementsByClassName("targeNode", "p")
                    // e.innerHTML="execute a paste"
                });
            },
            Register:function(tag,value,func){
                var MainKey="";
                switch(tag){
                    case 0:
                        MainKey=17; //Ctrl
                        break;
                    case 1:
                        MainKey=16; //Shift
                        break;
                    case 2:
                        MainKey="18"; //Alt
                        break;
                }
                document.onkeyup=function(e){
                    HotKeyHandler.currentMainKey=null;
                }

                document.onkeydown=function(event){
//获取键值
                    var keyCode= event.keyCode ;
                    var keyValue = String.fromCharCode(event.keyCode);

                    if(HotKeyHandler.currentMainKey!=null){
                        if(keyValue==value){
                            HotKeyHandler.currentMainKey=null;
                            if(func!=null) {
                                event.returnValue = func();
                            }
                        }
                    }
                    if(keyCode==MainKey) {
                        HotKeyHandler.currentMainKey = keyCode;
                    }
                }
            }
        }
    </script>
</head>
<body>
测试，按下ctrl+k你就会发现神奇的事情发生了
<p class="targeNode">
    this is placehold
</p>
<textarea contenteditable="true" id="test-text" name="nativeBacktrace" autofocus="false"></textarea>
</body>
</html>